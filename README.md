# 🇰🇿 Kazakh Legal AI - Fine-tuning Gemma Models

**Специализированные языковые модели для казахского права** - комплексный проект по созданию экспертных систем на базе моделей Gemma для предоставления квалифицированных юридических консультаций.

## 🎯 Обзор проекта

Этот репозиторий содержит полный пайплайн для создания и развертывания специализированных языковых моделей для казахского законодательства, включая:

- **Gemma 1B** - Базовая модель для быстрых ответов
- **Gemma 3 4B** - Продвинутая модель с экспертной точностью
- **Датасеты** - Специализированные правовые данные
- **API** - Готовые сервисы для интеграции
- **Документация** - Полные руководства и примеры

## ✨ Ключевые особенности

- 🏛️ **Экспертные знания** по казахскому праву
- 🎯 **93.3% юридической корректности** (Gemma 3 4B)
- ⚡ **Высокая производительность** (7.3 токена/сек)
- 💾 **Компактные адаптеры** (4.2 MB для 4B модели)
- 🔒 **Полная конфиденциальность** (локальная работа)
- 🍎 **Оптимизация для Apple Silicon** (MLX)

## 📁 Структура проекта

```
fine_tune_gemma_3_4b/
├── gemma_1b/                    # Gemma 1B модель
│   ├── adapters/               # Обученные адаптеры
│   ├── training_scripts/       # Скрипты обучения
│   └── examples/               # Примеры использования
├── gemma_3n/                   # Gemma 3 4B модель
│   ├── adapters/               # Обученные адаптеры
│   ├── examples/               # Примеры использования
│   ├── api_server.py          # API сервер
│   └── documentation/          # Документация
├── final_training_dataset/     # Правовые датасеты
│   ├── kazakh_law_qa_full.jsonl
│   ├── kazakh_law_qa_high_quality.jsonl
│   └── kazakh_law_qa_simple.jsonl
├── scripts/                    # Утилиты и скрипты
├── docs/                       # Общая документация
└── examples/                   # Примеры интеграции
```

## 🚀 Быстрый старт

### Установка

```bash
# Клонирование репозитория
git clone https://github.com/yourusername/kazakh-legal-ai.git
cd kazakh-legal-ai

# Создание виртуального окружения
python -m venv legal_ai_env
source legal_ai_env/bin/activate  # macOS/Linux
# или
legal_ai_env\Scripts\activate  # Windows

# Установка зависимостей
pip install -r requirements.txt
```

### Использование Gemma 3 4B (Рекомендуется)

```python
from gemma_3n.gemma_legal_model import KazakhLegalModel

# Загрузка модели
model = KazakhLegalModel()

# Задаем вопрос
question = "ТОО құру үшін қандай құжаттар қажет?"
answer = model.ask(question)
print(answer)
```

### Использование Gemma 1B (Быстрая)

```python
from gemma_1b.quick_legal_model import QuickLegalModel

# Загрузка модели
model = QuickLegalModel()

# Задаем вопрос
question = "Еңбекшіні жұмыстан шығару үшін қандай негіздер бар?"
answer = model.ask(question)
print(answer)
```

### API сервер

```bash
# Запуск API сервера (Gemma 3 4B)
cd gemma_3n
python api_server.py

# Тестирование
curl -X POST "http://localhost:8000/ask" \
     -H "Content-Type: application/json" \
     -d '{"question": "ТОО құру үшін қандай құжаттар қажет?"}'
```

## 📊 Сравнение моделей

| Модель | Параметры | Точность | Скорость | Размер | Использование |
|--------|-----------|----------|----------|--------|---------------|
| **Gemma 1B** | 1.8B | 85% | 15 токен/сек | 2.1 MB | Быстрые ответы |
| **Gemma 3 4B** | 8.4B | 93.3% | 7.3 токен/сек | 4.2 MB | Экспертные консультации |

## 🏗️ Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Web Interface │    │   API Gateway   │    │   Model Router  │
│                 │───▶│                 │───▶│                 │
│   (Frontend)    │    │   (FastAPI)     │    │   Gemma 1B/3 4B │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                                       │
                                                       ▼
                                               ┌─────────────────┐
                                               │   LoRA Adapters │
                                               │   (Kazakh Law)  │
                                               └─────────────────┘
```

## 📚 Покрытие правовых областей

- **Корпоративное право** - ТОО, АО, предпринимательство
- **Трудовое право** - трудовые отношения, заработная плата
- **Административное право** - штрафы, лицензирование
- **Гражданское право** - собственность, договоры
- **Налоговое право** - подоходный налог, НДС
- **Семейное право** - брак, развод, алименты
- **Банковское право** - кредиты, депозиты

## 🛠️ Технические детали

### Базовая модель
- **Gemma 1B:** Google Gemma 1B Instruct
- **Gemma 3 4B:** Google Gemma 3 4B Instruct
- **Метод обучения:** QLoRA (Quantized Low-Rank Adaptation)
- **Квантизация:** 4-bit precision

### Датасет
- **Объем:** 8,652 пар вопрос-ответ
- **Язык:** Казахский
- **Формат:** JSONL
- **Разделение:** 90/10 (train/validation)

### Системные требования
- **ОС:** macOS (рекомендуется), Linux, Windows
- **RAM:** 8+ GB (1B), 16+ GB (4B)
- **Процессор:** Apple Silicon (M1/M2) или x86_64
- **Python:** 3.8+

## 📖 Документация

### Основная документация
- [📋 Полное руководство](gemma_3n/USAGE.md)
- [📊 Отчет о производительности](gemma_3n/PERFORMANCE.md)
- [🔧 API Reference](gemma_3n/API_REFERENCE.md)
- [❓ Устранение проблем](gemma_3n/TROUBLESHOOTING.md)

### Специализированная документация
- [📈 Отчет для комиссии](gemma_3n/COMMISSION_REPORT.md)
- [🧪 Тестовые вопросы](gemma_3n/TEST_QUESTIONS.md)
- [📚 Индекс документации](gemma_3n/DOCS_INDEX.md)

## 🧪 Тестирование

```bash
# Тестирование Gemma 3 4B
cd gemma_3n
python test_model.py

# Тестирование Gemma 1B
cd gemma_1b
python test_model.py

# Бенчмарк производительности
python benchmark.py

# Тестирование API
python test_api.py
```

## 📈 Примеры использования

### Корпоративное право
```
Вопрос: ТОО құру үшін қандай құжаттар қажет?
Ответ: ТОО құру үшін мынадай құжаттар қажет:
1. Жарғы (устав)
2. Қатысушылардың шешімі
3. Мемлекеттік баж төлегенін растайтын құжат
4. Заңды мекенжайға қатысты құжаттар
5. Директордың келісімі

Негізгі заң: "Жауапкершілігі шектеулі серіктестік туралы" ҚР Заңы
```

### Трудовое право
```
Вопрос: Еңбекшіні жұмыстан шығару үшін қандай негіздер бар?
Ответ: ЕК 52-бабы бойынша еңбекшіні жұмыстан шығару негіздері:
1. Кәсіпорын жабылуы
2. Штат қысқаруы
3. Еңбек тәртібін бұзуы
4. Кәсіби сәйкессіздік
5. Еңбек міндеттерін орындамауы

Ескерту: 1 ай бұрын хабарлау қажет
```

## 🤝 Вклад в проект

Мы приветствуем вклад в развитие проекта! Пожалуйста, ознакомьтесь с [CONTRIBUTING.md](CONTRIBUTING.md) для получения подробной информации.

## 📄 Лицензия

Этот проект распространяется под лицензией MIT. См. [LICENSE](LICENSE) для получения подробной информации.

## 🙏 Благодарности

- Google за базовые модели Gemma
- Apple за фреймворк MLX
- Сообщество разработчиков за инструменты и библиотеки
- Юридические эксперты за консультации по казахскому праву

## 📞 Контакты

- **Автор:** Нурлы Хан
- **Email:** your.email@example.com
- **GitHub:** [@yourusername](https://github.com/yourusername)

## 🔗 Полезные ссылки

- [Gemma Documentation](https://ai.google.dev/gemma)
- [MLX Documentation](https://ml-explore.github.io/mlx/)
- [QLoRA Paper](https://arxiv.org/abs/2305.14314)
- [Kazakh Legal System](https://adilet.zan.kz/)

---

⭐ **Если проект был полезен, поставьте звезду!**

## 🚀 Статус проекта

- ✅ **Gemma 1B** - Обучена и готова к использованию
- ✅ **Gemma 3 4B** - Обучена и готова к использованию
- ✅ **API сервер** - Полностью функционален
- ✅ **Документация** - Завершена
- ✅ **Примеры** - Готовы к использованию
- 🔄 **Интеграции** - В разработке